---
import { site } from '../consts' 
import { config_site } from '../_config'
import Head from '../components/Head.vue'
import Header from '../components/Header.vue'
import Footer from '../components/Footer.vue'
import { Image } from 'astro:assets';
import avatar from '../../public/avatar.jpg';
import '../styles/home.styl'
import Clock from '../components/others/Clock.vue'
import SocialLinks from '../components/others/SocialLinks.vue'
import TextTyping from '../components/others/TextTyping.vue'
import AuthorCard from '../components/others/AuthorCard.astro'
import '@fortawesome/fontawesome-free/css/all.min.css'

// 确保头像路径有效，提供回退机制

const avatarImage = config_site.avatarPath || site.avatarPath;
---
<!DOCTYPE html>
<html lang={config_site.lang !== undefined ? config_site.lang : (site.lang || '')}>
    <Head
        title={config_site.title !== undefined ? config_site.title : (site.title || '')}
        description={config_site.description !== undefined ? config_site.description : (site.description || '')}
        url={config_site.url !== undefined ? config_site.url : (site.url || '')}
        keywords={config_site.keywords !== undefined ? config_site.keywords : (site.keywords || '')}
        author={config_site.author !== undefined ? config_site.author : (site.author || '')}
        lang={config_site.lang !== undefined ? config_site.lang : (site.lang || '')}
        locale={config_site.locale !== undefined ? config_site.locale : (site.locale || '')}
        siteName={config_site.siteName !== undefined ? config_site.siteName : (site.siteName || '')}
        favicon={config_site.favicon !== undefined ? config_site.favicon : (site.favicon || '')}
        appleTouchIcon={config_site.appleTouchIcon !== undefined ? config_site.appleTouchIcon : (site.appleTouchIcon || '')}
        ogImage={config_site.ogImage !== undefined ? config_site.ogImage : (site.ogImage || '')}
        twitterImage={config_site.twitterImage !== undefined ? config_site.twitterImage : (site.twitterImage || '')}
        twitterCreator={config_site.twitterCreator !== undefined ? config_site.twitterCreator : (site.twitterCreator || '')}
        structuredData={config_site.structuredData !== undefined ? config_site.structuredData : (site.structuredData || '')}
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=1.0">
    <script>
        import '../scripts/background.ts';
    </script>
    <body>
        <div class="main-wrapper">
            <div class="container">
                <div class="title"><h1>{ config_site.title||site.title||'Stalux'}</h1></div>
                <Header />
                <AuthorCard 
                    author={config_site.author || site.author } 
                    avatarPath={avatarImage}
                    avatarWidth={100}
                    avatarHeight={100}
                >
                </AuthorCard>
                <TextTyping client:idle />
                <Clock client:idle format="24hour" showDate={true} updateInterval={1000} />
                <SocialLinks client:only="vue" mediaLinks={config_site.medialinks || []} />
            </div>
        </div>
        <Footer/>
    </body>
</html>